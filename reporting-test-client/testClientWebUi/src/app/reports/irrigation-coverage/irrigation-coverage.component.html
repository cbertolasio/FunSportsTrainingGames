<h4 class="display-4 my-4">Irrigation Events:</h4>
<form [formGroup]="inputForm" (ngSubmit)="onSubmit()">
  <div class="form-row">
    <div class="form-group col-md-3">
      <label for="pivotIdInput">Pivot Id</label>
      <input type="text" id="pivotIdInput" class="form-control" aria-describedby="pivotIdHelp" placeholder="Enter Pivot Id" formControlName="pivotId">
      <small id="pivotIdHelp" class="form-text text-muted">Enter the identifier of the pivot you are searching for</small>
    </div>
  </div>
  <div class="form-row">
    <div class="form-group col col-md-6">
      <label for="datePicker">Date Range</label>
      <ngb-datepicker id="datePicker" #dp (select)="onDateSelection($event)" [displayMonths]="3" [dayTemplate]="t"></ngb-datepicker>

      <ng-template #t let-date="date" let-focused="focused">
        <span class="custom-day" [class.focused]="focused" [class.range]="isFrom(date) || isTo(date) || isInside(date) || isHovered(date)"
          [class.faded]="isHovered(date) || isInside(date)" (mouseenter)="hoveredDate = date" (mouseleave)="hoveredDate = null">
          {{date.day}}
        </span>
      </ng-template>
      <!-- <div class="justify-content-end">
        <pre class="">From: {{inputForm.value.startDate | json}} </pre>
        <pre class="">To: {{inputForm.value.stopDate | json }} </pre>
      </div> -->
    </div>
  </div>
  <div class="row">
    <div class="form-group col col-md-3">
      <label for="startTime">Start Time</label>
      <ngb-timepicker id="startTime" formControlName="startTime"></ngb-timepicker>
      <!-- <hr>
      <pre>Selected Time: {{model.startTime | json}}</pre> -->
    </div>
    <div class="form-group col col-md-3">
      <label for="stopTime">Stop Time</label>
      <ngb-timepicker id="stopTime" formControlName="stopTime"></ngb-timepicker>
      <!-- <hr>
      <pre>Selected Time: {{model.stopTime | json}}</pre> -->
    </div>
  </div>

  <div class="row">
    <div class="form-group col col-md-2">
      <label for="startBearing">Start Bearing</label>
      <input id="startBearing" class="form-control" type="number" formControlName="startBearing" min="1" max="360">
    </div>
    <div class="form-group col col-md-2">
      <label for="stopBearing">Stop Bearing</label>
      <input id="stopBearing" class="form-control" type="number" formControlName="stopBearing" min="1" max="360">
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
      <button type="submit" class="btn btn-primary btn-block">Search</button>
    </div>
  </div>
</form>
<br>
<div *ngIf="!loading && !hasData">
  <p>No events match your criteria, please refine your search.</p>
</div>
<div *ngIf="!loading && hasData" class="table-responsive">
  <h3>Event Summary: </h3>
  <p>Total Events: <span>{{irrigationEvents.totalEvents}}</span></p>
  <p>Total Events with 0 unknown bearings: <span>{{irrigationEvents.totalEventsWithUnknownBearings}}</span></p>
  <p>% of Events with unknown bearings: <span>{{irrigationEvents.percentageOfZeroBearings}} %</span></p>
  <h3>Event Detail:</h3>
  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">JournalId</th>
        <th scope="col">Bearing</th>
        <th scope="col">Direction</th>
        <th scope="col">Velocity</th>
        <th scope="col">Is Pump On?</th>
        <th scope="col">Schedule Id</th>
        <th scope="col">Substance Status</th>
        <th scope="col">Time Between Events (sec)</th>
        <th scope="col">Event Created On (local time)</th>
        <th scope="col">Event Created On (utc)</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of irrigationEvents.events | slice: (currentPage * pageSize) - pageSize : currentPage * pageSize" [class.selected]="item === selectedEvent"
        (click)="onSelect(item)">
        <td>{{item.journalId}}</td>
        <td>{{item.bearing}}</td>
        <td>{{item.direction}}</td>
        <td>{{item.velocity}}</td>
        <td>{{item.isPumpOn}}</td>
        <td>{{item.scheduleId}}</td>
        <td>{{item.displaySubstance}}</td>
        <td>{{item.timeBetweenEvents | amDuration:'seconds' }}</td>
        <td>{{item.createdDate | amFromUtc | amLocal | amDateFormat:'YYYY-MM-DD HH:mm:ss' }}</td>
        <td>{{item.createdDate | amFromUtc | amDateFormat:'YYYY-MM-DD HH:mm:ss' }}</td>
      </tr>
    </tbody>
  </table>
  <ngb-pagination (pageChange)="pageChanged($event)" [collectionSize]="collectionSize" [(page)]="currentPage" [maxSize]="5"
    [pageSize]="pageSize" [rotate]="true" size="lg" [boundaryLinks]="true"></ngb-pagination>
</div>